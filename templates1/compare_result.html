<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comparison Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">
  <div class="container mt-5">
    {% if comparison %}
      <h3 class="text-center mb-4">üìä {{ comparison.loc1_name.title() }} vs {{ comparison.loc2_name.title() }}</h3>

      <table class="table table-bordered text-center bg-white shadow-sm">
        <thead class="table-light">
          <tr>
            <th>Metric</th>
            <th>{{ comparison.loc1_name.title() }}</th>
            <th>{{ comparison.loc2_name.title() }}</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Avg Price (L)</td><td>{{ comparison.loc1_data.price_lakh|default(0) }}</td><td>{{ comparison.loc2_data.price_lakh|default(0) }}</td></tr>
          <tr><td>Rate/Sq.Ft.</td><td>{{ comparison.loc1_data.rate_sqft|default(0) }}</td><td>{{ comparison.loc2_data.rate_sqft|default(0) }}</td></tr>
          <tr><td>Avg Rent</td><td>{{ comparison.loc1_data.rent|default(0) }}</td><td>{{ comparison.loc2_data.rent|default(0) }}</td></tr>
          <tr><td>ROI (%)</td><td>{{ comparison.loc1_data.roi|default(0) }}</td><td>{{ comparison.loc2_data.roi|default(0) }}</td></tr>
        </tbody>
      </table>

      <canvas id="comparisonChart" height="100"></canvas>

      <script>
        new Chart(document.getElementById('comparisonChart').getContext('2d'), {
          type: 'bar',
          data: {
            labels: ['Price (L)', 'Rate/Sq.Ft.', 'Rent', 'ROI'],
            datasets: [
              {
                label: "{{ comparison.loc1_name.title() }}",
                data: [
                  {{ comparison.loc1_data.price_lakh|default(0) }},
                  {{ comparison.loc1_data.rate_sqft|default(0) }},
                  {{ comparison.loc1_data.rent|default(0) }},
                  {{ comparison.loc1_data.roi|default(0) }}
                ],
                backgroundColor: 'rgba(54, 162, 235, 0.7)'
              },
              {
                label: "{{ comparison.loc2_name.title() }}",
                data: [
                  {{ comparison.loc2_data.price_lakh|default(0) }},
                  {{ comparison.loc2_data.rate_sqft|default(0) }},
                  {{ comparison.loc2_data.rent|default(0) }},
                  {{ comparison.loc2_data.roi|default(0) }}
                ],
                backgroundColor: 'rgba(255, 99, 132, 0.7)'
              }
            ]
          },
          options: {
            responsive: true,
            scales: {
              y: { beginAtZero: true }
            }
          }
        });
      </script>
    {% else %}
      <h4 class="text-center text-danger">‚ö†Ô∏è No data available to show comparison. Please check your inputs.</h4>
    {% endif %}
  </div>
</body>
</html>